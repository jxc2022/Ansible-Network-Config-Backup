---
- name: "PLAY 2: Get the Data From IOS Device"
  hosts: all
  connection: network_cli
  collections:
    - cisco.ios
  tasks:
    - name: "TASK 1: Get the device config"
      ios_command:
        commands: "show running-config"
      register: cli_result_config
    
    - debug: msg="{{cli_result_config.stdout}}"

    - name: "TASK 2 : Create outputs/ folder"
      file:
        path: "flash/ansible"  #Path of the create folder
        state: directory
      run_once: true
      register: outfolder
    
    - debug: msg="{{inventory_hostname}}"
  

    - name: "TASK 3 : Write config to file"
      copy:
        content: "{{ cli_result_config.stdout}}\n" #Get content from output from Task 1
        dest: "flash/ansible/{{inventory_hostname}}.cfg"
    
    - name: Configure the login banner
      cisco.ios.ios_banner:
      banner: login
      text: |
        "this is my login banner
        that contains a multiline
        string"
      state: present
        
    
    - name: Gathering hardware info
      cisco.ios.ios_facts:
        gather_subset: hardware
